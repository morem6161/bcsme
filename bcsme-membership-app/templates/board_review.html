{% extends "base.html" %}

{% block title %}Board Review List - BCSME{% endblock %}

{% block extra_css %}
<style>
@media print {
    header, nav, footer, .no-print {
        display: none !important;
    }
    
    body {
        font-size: 12pt;
    }
    
    .board-review {
        max-width: 100%;
    }
    
    .page-break {
        page-break-after: always;
    }
}

.board-review {
    max-width: 1200px;
    margin: 0 auto;
    background: white;
    padding: 40px;
}

.review-header {
    text-align: center;
    border-bottom: 3px solid #2c5f2d;
    padding-bottom: 20px;
    margin-bottom: 30px;
}

.review-table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
}

.review-table th {
    background: #2c5f2d;
    color: white;
    padding: 12px;
    text-align: left;
    font-weight: 600;
}

.review-table td {
    padding: 10px 12px;
    border-bottom: 1px solid #ddd;
    vertical-align: top;
}

.review-table tr:nth-child(even) {
    background: #f8f9fa;
}

.applicant-details {
    font-size: 0.9em;
    color: #666;
    margin-top: 5px;
}

.notes-section {
    background: #f8f9fa;
    padding: 15px;
    margin: 30px 0;
    border-radius: 8px;
}

.signature-line {
    margin-top: 60px;
    border-top: 2px solid #000;
    padding-top: 10px;
}

.print-btn {
    margin: 20px 0;
}
</style>
{% endblock %}

{% block content %}
<div class="no-print print-btn">
    <button onclick="window.print()" class="btn btn-primary">üñ®Ô∏è Print Board Review List</button>
    <a href="{{ url_for('admin_dashboard') }}" class="btn btn-secondary">‚Üê Back to Dashboard</a>
</div>

<div class="board-review">
    <div class="review-header">
        <h1>British Columbia Society of Model Engineers</h1>
        <h2>Board Review - Membership Applications</h2>
        <p><strong>Meeting Date:</strong> _____________________</p>
        <p><strong>Generated:</strong> {{ current_date }}</p>
        <p><strong>Total Applications for Review:</strong> {{ members|length }}</p>
    </div>
    
    {% if members %}
        <table class="review-table">
            <thead>
                <tr>
                    <th style="width: 5%;">#</th>
                    <th style="width: 20%;">Name</th>
                    <th style="width: 15%;">Category</th>
                    <th style="width: 15%;">Contact</th>
                    <th style="width: 20%;">Special Requirements</th>
                    <th style="width: 10%;">Fee</th>
                    <th style="width: 15%;">Decision</th>
                </tr>
            </thead>
            <tbody>
                {% for member in members %}
                <tr>
                    <td>{{ loop.index }}</td>
                    <td>
                        <strong>{{ member.name }}</strong>
                        <div class="applicant-details">
                            Applied: {{ member.application_date.strftime('%Y-%m-%d') }}<br>
                            {% if member.birthdate %}
                            Age: {{ (now.year - member.birthdate.year - ((now.month, now.day) < (member.birthdate.month, member.birthdate.day))) }}
                            {% endif %}
                        </div>
                    </td>
                    <td>{{ member.membership_category }}</td>
                    <td>
                        {{ member.email }}<br>
                        {% if member.phone_other %}
                        {{ member.phone_other }}
                        {% endif %}
                    </td>
                    <td>
                        {% if member.membership_category == 'Junior' %}
                            <strong>Sponsors Required:</strong><br>
                            1. {{ member.sponsor1_name }}
                            {% if member.sponsor1_status == 'verified' %}‚úì{% elif member.sponsor1_status == 'not_found' %}‚ö†Ô∏è Not Found{% endif %}<br>
                            2. {{ member.sponsor2_name }}
                            {% if member.sponsor2_status == 'verified' %}‚úì{% elif member.sponsor2_status == 'not_found' %}‚ö†Ô∏è Not Found{% endif %}
                        {% elif member.membership_category == 'Probationary' %}
                            <strong>Guardian:</strong><br>
                            {{ member.parent_guardian_signature }}
                        {% else %}
                            None
                        {% endif %}
                    </td>
                    <td>${{ "%.2f"|format(member.membership_fee) }}</td>
                    <td>
                        ‚òê Approve<br>
                        ‚òê Reject<br>
                        ‚òê Defer
                    </td>
                </tr>
                
                {% if loop.index % 5 == 0 and not loop.last %}
                </tbody>
        </table>
        <div class="page-break"></div>
        <div class="review-header">
            <h2>Membership Applications (continued)</h2>
        </div>
        <table class="review-table">
            <thead>
                <tr>
                    <th style="width: 5%;">#</th>
                    <th style="width: 20%;">Name</th>
                    <th style="width: 15%;">Category</th>
                    <th style="width: 15%;">Contact</th>
                    <th style="width: 20%;">Special Requirements</th>
                    <th style="width: 10%;">Fee</th>
                    <th style="width: 15%;">Decision</th>
                </tr>
            </thead>
            <tbody>
                {% endif %}
                
                {% endfor %}
            </tbody>
        </table>
        
        <div class="notes-section">
            <h3>Notes / Discussion Points:</h3>
            <p>&nbsp;</p>
            <p>&nbsp;</p>
            <p>&nbsp;</p>
            <p>&nbsp;</p>
        </div>
        
        <div class="signature-line">
            <p><strong>Board Secretary:</strong> ___________________________________ <strong>Date:</strong> ______________</p>
        </div>
        
    {% else %}
        <p class="empty-message">No pending applications to review at this time.</p>
    {% endif %}
</div>

<script>
// Add current date
document.addEventListener('DOMContentLoaded', function() {
    const now = new Date();
    const dateStr = now.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
    document.querySelectorAll('.current-date-placeholder').forEach(el => {
        el.textContent = dateStr;
    });
});
</script>
{% endblock %}
